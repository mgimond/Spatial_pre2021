<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Intro to GIS and Spatial Analysis</title>
  <meta name="description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Intro to GIS and Spatial Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  <meta name="github-repo" content="mgimond/spatial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Intro to GIS and Spatial Analysis" />
  
  <meta name="twitter:description" content="This is a compilation of lecture notes that accompany my Intro to GIS and Spatial Analysis course." />
  

<meta name="author" content="Manuel Gimond">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="data-manipulation-in-r.html">
<link rel="next" href="vector-operations-in-r.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #0000ff; } /* Keyword */
code > span.ch { color: #008080; } /* Char */
code > span.st { color: #008080; } /* String */
code > span.co { color: #008000; } /* Comment */
code > span.ot { color: #ff4000; } /* Other */
code > span.al { color: #ff0000; } /* Alert */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #008000; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #008080; } /* SpecialChar */
code > span.vs { color: #008080; } /* VerbatimString */
code > span.ss { color: #008080; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #0000ff; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ff4000; } /* Preprocessor */
code > span.do { color: #008000; } /* Documentation */
code > span.an { color: #008000; } /* Annotation */
code > span.cv { color: #008000; } /* CommentVar */
code > span.at { } /* Attribute */
code > span.in { color: #008000; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introGIS.html"><a href="introGIS.html"><i class="fa fa-check"></i><b>1</b> Introduction to GIS</a><ul>
<li class="chapter" data-level="1.1" data-path="introGIS.html"><a href="introGIS.html#what-is-a-gis"><i class="fa fa-check"></i><b>1.1</b> What is a GIS?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introGIS.html"><a href="introGIS.html#gis-software"><i class="fa fa-check"></i><b>1.1.1</b> GIS software</a></li>
<li class="chapter" data-level="1.1.2" data-path="introGIS.html"><a href="introGIS.html#qgis"><i class="fa fa-check"></i><b>1.1.2</b> QGIS</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introGIS.html"><a href="introGIS.html#what-is-spatial-analysis"><i class="fa fa-check"></i><b>1.2</b> What is Spatial Analysis?</a></li>
<li class="chapter" data-level="1.3" data-path="introGIS.html"><a href="introGIS.html#whats-in-an-acronym"><i class="fa fa-check"></i><b>1.3</b> What’s in an Acronym?</a></li>
</ul></li>
<li class="part"><span><b>I Working with spatial data</b></span></li>
<li class="chapter" data-level="2" data-path="feature-representation.html"><a href="feature-representation.html"><i class="fa fa-check"></i><b>2</b> Feature Representation</a><ul>
<li class="chapter" data-level="2.1" data-path="feature-representation.html"><a href="feature-representation.html#vector-vs.raster"><i class="fa fa-check"></i><b>2.1</b> Vector vs. Raster</a><ul>
<li class="chapter" data-level="2.1.1" data-path="feature-representation.html"><a href="feature-representation.html#vector"><i class="fa fa-check"></i><b>2.1.1</b> Vector</a></li>
<li class="chapter" data-level="2.1.2" data-path="feature-representation.html"><a href="feature-representation.html#raster"><i class="fa fa-check"></i><b>2.1.2</b> Raster</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="feature-representation.html"><a href="feature-representation.html#object-vs.field"><i class="fa fa-check"></i><b>2.2</b> Object vs. Field</a><ul>
<li class="chapter" data-level="2.2.1" data-path="feature-representation.html"><a href="feature-representation.html#object-view"><i class="fa fa-check"></i><b>2.2.1</b> Object View</a></li>
<li class="chapter" data-level="2.2.2" data-path="feature-representation.html"><a href="feature-representation.html#field-view"><i class="fa fa-check"></i><b>2.2.2</b> Field View</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="feature-representation.html"><a href="feature-representation.html#scale"><i class="fa fa-check"></i><b>2.3</b> Scale</a></li>
<li class="chapter" data-level="2.4" data-path="feature-representation.html"><a href="feature-representation.html#attribute-tables"><i class="fa fa-check"></i><b>2.4</b> Attribute Tables</a><ul>
<li class="chapter" data-level="2.4.1" data-path="feature-representation.html"><a href="feature-representation.html#measurement-levels"><i class="fa fa-check"></i><b>2.4.1</b> Measurement Levels</a></li>
<li class="chapter" data-level="2.4.2" data-path="feature-representation.html"><a href="feature-representation.html#data-type"><i class="fa fa-check"></i><b>2.4.2</b> Data type</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gis-data-management.html"><a href="gis-data-management.html"><i class="fa fa-check"></i><b>3</b> GIS Data Management</a><ul>
<li class="chapter" data-level="3.1" data-path="gis-data-management.html"><a href="gis-data-management.html#gis-file-data-formats"><i class="fa fa-check"></i><b>3.1</b> GIS File Data Formats</a><ul>
<li class="chapter" data-level="3.1.1" data-path="gis-data-management.html"><a href="gis-data-management.html#vector-data-file-formats"><i class="fa fa-check"></i><b>3.1.1</b> Vector Data File Formats</a></li>
<li class="chapter" data-level="3.1.2" data-path="gis-data-management.html"><a href="gis-data-management.html#raster-data-file-formats"><i class="fa fa-check"></i><b>3.1.2</b> Raster Data File Formats</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-gis-files"><i class="fa fa-check"></i><b>3.2</b> Managing GIS Files</a></li>
<li class="chapter" data-level="3.3" data-path="gis-data-management.html"><a href="gis-data-management.html#managing-a-map-project-in-arcgis"><i class="fa fa-check"></i><b>3.3</b> Managing a Map Project in ArcGIS</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="symbolizing-features.html"><a href="symbolizing-features.html"><i class="fa fa-check"></i><b>4</b> Symbolizing features</a><ul>
<li class="chapter" data-level="4.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color"><i class="fa fa-check"></i><b>4.1</b> Color</a><ul>
<li class="chapter" data-level="4.1.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#hue"><i class="fa fa-check"></i><b>4.1.1</b> Hue</a></li>
<li class="chapter" data-level="4.1.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#lightness"><i class="fa fa-check"></i><b>4.1.2</b> Lightness</a></li>
<li class="chapter" data-level="4.1.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#saturation"><i class="fa fa-check"></i><b>4.1.3</b> Saturation</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#color-space"><i class="fa fa-check"></i><b>4.2</b> Color Space</a></li>
<li class="chapter" data-level="4.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification"><i class="fa fa-check"></i><b>4.3</b> Classification</a><ul>
<li class="chapter" data-level="4.3.1" data-path="symbolizing-features.html"><a href="symbolizing-features.html#qualitative-color-scheme"><i class="fa fa-check"></i><b>4.3.1</b> Qualitative color scheme</a></li>
<li class="chapter" data-level="4.3.2" data-path="symbolizing-features.html"><a href="symbolizing-features.html#sequential-color-scheme"><i class="fa fa-check"></i><b>4.3.2</b> Sequential color scheme</a></li>
<li class="chapter" data-level="4.3.3" data-path="symbolizing-features.html"><a href="symbolizing-features.html#divergent-color-scheme"><i class="fa fa-check"></i><b>4.3.3</b> Divergent color scheme</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="symbolizing-features.html"><a href="symbolizing-features.html#so-how-do-i-find-a-proper-color-scheme-for-my-data"><i class="fa fa-check"></i><b>4.4</b> So how do I find a proper color scheme for my data?</a></li>
<li class="chapter" data-level="4.5" data-path="symbolizing-features.html"><a href="symbolizing-features.html#classification-intervals"><i class="fa fa-check"></i><b>4.5</b> Classification Intervals</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html"><i class="fa fa-check"></i><b>5</b> Pitfalls to avoid</a><ul>
<li class="chapter" data-level="5.1" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#representing-count"><i class="fa fa-check"></i><b>5.1</b> Representing Count</a></li>
<li class="chapter" data-level="5.2" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#maup"><i class="fa fa-check"></i><b>5.2</b> MAUP</a></li>
<li class="chapter" data-level="5.3" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#ecological-fallacy"><i class="fa fa-check"></i><b>5.3</b> Ecological Fallacy</a></li>
<li class="chapter" data-level="5.4" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#mapping-rates"><i class="fa fa-check"></i><b>5.4</b> Mapping rates</a></li>
<li class="chapter" data-level="5.5" data-path="pitfalls-to-avoid.html"><a href="pitfalls-to-avoid.html#coping-with-unstable-rates"><i class="fa fa-check"></i><b>5.5</b> Coping with Unstable Rates</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html"><i class="fa fa-check"></i><b>6</b> Good Map Making Tips</a><ul>
<li class="chapter" data-level="6.1" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#elements-of-a-map"><i class="fa fa-check"></i><b>6.1</b> Elements of a map</a></li>
<li class="chapter" data-level="6.2" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#how-to-create-a-good-map"><i class="fa fa-check"></i><b>6.2</b> How to create a <em>good</em> map</a></li>
<li class="chapter" data-level="6.3" data-path="good-map-making-tips.html"><a href="good-map-making-tips.html#typefaces-and-fonts"><i class="fa fa-check"></i><b>6.3</b> Typefaces and Fonts</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html"><i class="fa fa-check"></i><b>7</b> Uncertainty in Census Data</a><ul>
<li class="chapter" data-level="7.1" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#mapping-uncertainty"><i class="fa fa-check"></i><b>7.2</b> Mapping uncertainty</a></li>
<li class="chapter" data-level="7.3" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#problems-in-mapping-uncertainty"><i class="fa fa-check"></i><b>7.3</b> Problems in mapping uncertainty</a></li>
<li class="chapter" data-level="7.4" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#class-comparison-maps"><i class="fa fa-check"></i><b>7.4</b> Class comparison maps</a></li>
<li class="chapter" data-level="7.5" data-path="uncertainty-in-census-data.html"><a href="uncertainty-in-census-data.html#problem-when-performing-bivariate-analysis"><i class="fa fa-check"></i><b>7.5</b> Problem when performing bivariate analysis</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html"><i class="fa fa-check"></i><b>8</b> Spatial Operations and Vector Overlays</a><ul>
<li class="chapter" data-level="8.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-attribute"><i class="fa fa-check"></i><b>8.1</b> Selection by Attribute</a><ul>
<li class="chapter" data-level="8.1.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#set-algebra"><i class="fa fa-check"></i><b>8.1.1</b> Set Algebra</a></li>
<li class="chapter" data-level="8.1.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#boolean-algebra"><i class="fa fa-check"></i><b>8.1.2</b> Boolean Algebra</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#selection-by-location"><i class="fa fa-check"></i><b>8.2</b> Selection by location</a></li>
<li class="chapter" data-level="8.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#vector-overlay"><i class="fa fa-check"></i><b>8.3</b> Vector Overlay</a><ul>
<li class="chapter" data-level="8.3.1" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#clip"><i class="fa fa-check"></i><b>8.3.1</b> Clip</a></li>
<li class="chapter" data-level="8.3.2" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#intersect"><i class="fa fa-check"></i><b>8.3.2</b> Intersect</a></li>
<li class="chapter" data-level="8.3.3" data-path="spatial-operations-and-vector-overlays.html"><a href="spatial-operations-and-vector-overlays.html#union"><i class="fa fa-check"></i><b>8.3.3</b> Union</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="coordinate-systems.html"><a href="coordinate-systems.html"><i class="fa fa-check"></i><b>9</b> Coordinate Systems</a><ul>
<li class="chapter" data-level="9.1" data-path="coordinate-systems.html"><a href="coordinate-systems.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>9.1</b> Geographic Coordinate Systems</a><ul>
<li class="chapter" data-level="9.1.1" data-path="coordinate-systems.html"><a href="coordinate-systems.html#sphere-and-ellipsoid"><i class="fa fa-check"></i><b>9.1.1</b> Sphere and Ellipsoid</a></li>
<li class="chapter" data-level="9.1.2" data-path="coordinate-systems.html"><a href="coordinate-systems.html#geoid"><i class="fa fa-check"></i><b>9.1.2</b> Geoid</a></li>
<li class="chapter" data-level="9.1.3" data-path="coordinate-systems.html"><a href="coordinate-systems.html#datum"><i class="fa fa-check"></i><b>9.1.3</b> Datum</a></li>
<li class="chapter" data-level="9.1.4" data-path="coordinate-systems.html"><a href="coordinate-systems.html#building-the-geographic-coordinate-system"><i class="fa fa-check"></i><b>9.1.4</b> Building the Geographic Coordinate System</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="coordinate-systems.html"><a href="coordinate-systems.html#projected-coordinate-systems"><i class="fa fa-check"></i><b>9.2</b> Projected Coordinate Systems</a><ul>
<li class="chapter" data-level="9.2.1" data-path="coordinate-systems.html"><a href="coordinate-systems.html#planar-projections"><i class="fa fa-check"></i><b>9.2.1</b> Planar Projections</a></li>
<li class="chapter" data-level="9.2.2" data-path="coordinate-systems.html"><a href="coordinate-systems.html#cylindrical-projection"><i class="fa fa-check"></i><b>9.2.2</b> Cylindrical Projection</a></li>
<li class="chapter" data-level="9.2.3" data-path="coordinate-systems.html"><a href="coordinate-systems.html#conical-projection"><i class="fa fa-check"></i><b>9.2.3</b> Conical Projection</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="coordinate-systems.html"><a href="coordinate-systems.html#spatial-properties"><i class="fa fa-check"></i><b>9.3</b> Spatial Properties</a></li>
<li class="chapter" data-level="9.4" data-path="coordinate-systems.html"><a href="coordinate-systems.html#geodesic-geometries"><i class="fa fa-check"></i><b>9.4</b> Geodesic geometries</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="map-algebra.html"><a href="map-algebra.html"><i class="fa fa-check"></i><b>10</b> Map Algebra</a><ul>
<li class="chapter" data-level="10.1" data-path="map-algebra.html"><a href="map-algebra.html#local-operations-and-functions"><i class="fa fa-check"></i><b>10.1</b> Local operations and functions</a></li>
<li class="chapter" data-level="10.2" data-path="map-algebra.html"><a href="map-algebra.html#focal-operations-and-functions"><i class="fa fa-check"></i><b>10.2</b> Focal operations and functions</a></li>
<li class="chapter" data-level="10.3" data-path="map-algebra.html"><a href="map-algebra.html#zonal-operations-and-functions"><i class="fa fa-check"></i><b>10.3</b> Zonal operations and functions</a></li>
<li class="chapter" data-level="10.4" data-path="map-algebra.html"><a href="map-algebra.html#global-operations-and-functions"><i class="fa fa-check"></i><b>10.4</b> Global operations and functions</a></li>
<li class="chapter" data-level="10.5" data-path="map-algebra.html"><a href="map-algebra.html#operators-and-functions"><i class="fa fa-check"></i><b>10.5</b> Operators and functions</a><ul>
<li class="chapter" data-level="10.5.1" data-path="map-algebra.html"><a href="map-algebra.html#mathematical-operators-and-functions"><i class="fa fa-check"></i><b>10.5.1</b> Mathematical operators and functions</a></li>
<li class="chapter" data-level="10.5.2" data-path="map-algebra.html"><a href="map-algebra.html#logical-comparison"><i class="fa fa-check"></i><b>10.5.2</b> Logical comparison</a></li>
<li class="chapter" data-level="10.5.3" data-path="map-algebra.html"><a href="map-algebra.html#boolean-or-logical-operators"><i class="fa fa-check"></i><b>10.5.3</b> Boolean (or Logical) operators</a></li>
<li class="chapter" data-level="10.5.4" data-path="map-algebra.html"><a href="map-algebra.html#combining-operations"><i class="fa fa-check"></i><b>10.5.4</b> Combining operations</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Spatial Analysis</b></span></li>
<li class="chapter" data-level="11" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html"><i class="fa fa-check"></i><b>11</b> Point Pattern Analysis</a><ul>
<li class="chapter" data-level="11.1" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#centrography"><i class="fa fa-check"></i><b>11.1</b> Centrography</a></li>
<li class="chapter" data-level="11.2" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#density-based-analysis"><i class="fa fa-check"></i><b>11.2</b> Density based analysis</a><ul>
<li class="chapter" data-level="11.2.1" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#global-density"><i class="fa fa-check"></i><b>11.2.1</b> Global density</a></li>
<li class="chapter" data-level="11.2.2" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#local-density"><i class="fa fa-check"></i><b>11.2.2</b> Local density</a></li>
<li class="chapter" data-level="11.2.3" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#modeling-intensity-as-a-function-of-a-covariate"><i class="fa fa-check"></i><b>11.2.3</b> Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#distance-based-analysis"><i class="fa fa-check"></i><b>11.3</b> Distance based analysis</a><ul>
<li class="chapter" data-level="11.3.1" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#average-nearest-neighbor"><i class="fa fa-check"></i><b>11.3.1</b> Average Nearest Neighbor</a></li>
<li class="chapter" data-level="11.3.2" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#k-and-l-functions"><i class="fa fa-check"></i><b>11.3.2</b> K and L functions</a></li>
<li class="chapter" data-level="11.3.3" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#the-pair-correlation-function-g"><i class="fa fa-check"></i><b>11.3.3</b> The Pair Correlation Function <span class="math inline">\(g\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html#first-and-second-order-effects"><i class="fa fa-check"></i><b>11.4</b> First and second order effects</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>12</b> Hypothesis testing</a><ul>
<li class="chapter" data-level="12.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#irpcsr"><i class="fa fa-check"></i><b>12.1</b> IRP/CSR</a></li>
<li class="chapter" data-level="12.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#testing-for-csr-with-the-ann-tool"><i class="fa fa-check"></i><b>12.2</b> Testing for CSR with the ANN tool</a><ul>
<li class="chapter" data-level="12.2.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#arcgis-average-nearest-neighbor-tool"><i class="fa fa-check"></i><b>12.2.1</b> ArcGIS’ Average Nearest Neighbor Tool</a></li>
<li class="chapter" data-level="12.2.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#a-better-approach-a-monte-carlo-test"><i class="fa fa-check"></i><b>12.2.2</b> A better approach: a Monte Carlo test</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#alternatives-to-csrirp"><i class="fa fa-check"></i><b>12.3</b> Alternatives to CSR/IRP</a></li>
<li class="chapter" data-level="12.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#monte-carlo-test-with-k-and-l-functions"><i class="fa fa-check"></i><b>12.4</b> Monte Carlo test with K and L functions</a></li>
<li class="chapter" data-level="12.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#PPM"><i class="fa fa-check"></i><b>12.5</b> Testing for a covariate effect</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html"><i class="fa fa-check"></i><b>13</b> Spatial Autocorrelation</a><ul>
<li class="chapter" data-level="13.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#global-morans-i"><i class="fa fa-check"></i><b>13.1</b> Global Moran’s I</a><ul>
<li class="chapter" data-level="13.1.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#computing-the-morans-i"><i class="fa fa-check"></i><b>13.1.1</b> Computing the Moran’s I</a></li>
<li class="chapter" data-level="13.1.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#monte-carlo-approach-to-estimating-significance"><i class="fa fa-check"></i><b>13.1.2</b> Monte Carlo approach to estimating significance</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#morans-i-at-different-lags"><i class="fa fa-check"></i><b>13.2</b> Moran’s I at different lags</a></li>
<li class="chapter" data-level="13.3" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-morans-i"><i class="fa fa-check"></i><b>13.3</b> Local Moran’s I</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html"><i class="fa fa-check"></i><b>14</b> Spatial Interpolation</a><ul>
<li class="chapter" data-level="14.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#deterministic-approach-to-interpolation"><i class="fa fa-check"></i><b>14.1</b> Deterministic Approach to Interpolation</a><ul>
<li class="chapter" data-level="14.1.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#proximity-interpolation"><i class="fa fa-check"></i><b>14.1.1</b> Proximity interpolation</a></li>
<li class="chapter" data-level="14.1.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#inverse-distance-weighted-idw"><i class="fa fa-check"></i><b>14.1.2</b> Inverse Distance Weighted (IDW)</a></li>
<li class="chapter" data-level="14.1.3" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#fine-tuning-the-interpolation-parameters"><i class="fa fa-check"></i><b>14.1.3</b> Fine tuning the interpolation parameters</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#statistical-approach-to-interpolation"><i class="fa fa-check"></i><b>14.2</b> Statistical Approach to Interpolation</a><ul>
<li class="chapter" data-level="14.2.1" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#trend-surfaces"><i class="fa fa-check"></i><b>14.2.1</b> Trend Surfaces</a></li>
<li class="chapter" data-level="14.2.2" data-path="spatial-interpolation.html"><a href="spatial-interpolation.html#ordinary-kriging"><i class="fa fa-check"></i><b>14.2.2</b> Ordinary Kriging</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Appendix</b></span></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html"><i class="fa fa-check"></i>Data Manipulation in R</a><ul>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#reading-vector-files"><i class="fa fa-check"></i>Reading vector files</a><ul>
<li><a href="data-manipulation-in-r.html#reading-a-shapefile-with-rgdal">Reading a shapefile with <code>rgdal</code> ​</a></li>
<li><a href="data-manipulation-in-r.html#reading-a-shapefile-with-maptools">Reading a shapefile with <code>maptools</code> ​</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#reading-a-geopackage"><i class="fa fa-check"></i>Reading a GeoPackage</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#reading-gis-raster-files"><i class="fa fa-check"></i>Reading GIS raster files</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#dissecting-the-file-summary"><i class="fa fa-check"></i>Dissecting the file summary</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#mapping-spatial-data"><i class="fa fa-check"></i>Mapping spatial data</a><ul>
<li><a href="data-manipulation-in-r.html#mapping-with-spplot">Mapping with <code>spplot</code> ​</a></li>
<li><a href="data-manipulation-in-r.html#mapping-with-tmap">Mapping with <code>tmap</code> ​</a></li>
<li><a href="data-manipulation-in-r.html#mapping-rasters-with-tmap">Mapping rasters with <code>tmap</code> ​</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#joining-tables-to-spatial-features"><i class="fa fa-check"></i>Joining tables to spatial features</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#converting-xy-data-to-point-objects"><i class="fa fa-check"></i>Converting XY data to point objects</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#geocoding-street-addresses"><i class="fa fa-check"></i>Geocoding street addresses</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#exporting-to-a-shapefile"><i class="fa fa-check"></i>Exporting to a shapefile</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#exporting-to-a-geopackage"><i class="fa fa-check"></i>Exporting to a GeoPackage</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-in-r.html"><a href="data-manipulation-in-r.html#exporting-to-a-raster-file-format"><i class="fa fa-check"></i>Exporting to a raster file format</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html"><i class="fa fa-check"></i>Coordinate Systems in R</a><ul>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#checking-for-a-coordinate-system"><i class="fa fa-check"></i>Checking for a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#understanding-the-coordinate-syntax"><i class="fa fa-check"></i>Understanding the coordinate syntax</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#assigning-a-coordinate-system"><i class="fa fa-check"></i>Assigning a coordinate system</a></li>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#modifying-coordinate-systems"><i class="fa fa-check"></i>Modifying coordinate systems</a><ul>
<li class="chapter" data-level="" data-path="coordinate-systems-in-r.html"><a href="coordinate-systems-in-r.html#example-of-failed-transformations"><i class="fa fa-check"></i>Example of failed transformations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html"><i class="fa fa-check"></i>Vector operations in R</a><ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#dissolve-by-contiguous-shape"><i class="fa fa-check"></i>Dissolve by contiguous shape</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#dissolve-by-attribute"><i class="fa fa-check"></i>Dissolve by attribute</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#calculate-area"><i class="fa fa-check"></i>Calculate area</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#subsetting"><i class="fa fa-check"></i>Subsetting</a></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#intersecting"><i class="fa fa-check"></i>Intersecting</a><ul>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#intersecting-polygons-with-line-and-point-objects"><i class="fa fa-check"></i>Intersecting polygons with line and point objects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="vector-operations-in-r.html"><a href="vector-operations-in-r.html#unioning"><i class="fa fa-check"></i>Unioning</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html"><i class="fa fa-check"></i>Raster operations in R</a><ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#local-operations-and-functions-1"><i class="fa fa-check"></i>Local operations and functions</a><ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#unary-operations-and-functions-applied-to-single-raster"><i class="fa fa-check"></i>Unary operations and functions (applied to single raster)</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#binary-operations-and-functions-where-two-layers-are-used"><i class="fa fa-check"></i>Binary operations and functions (where two layers are used)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#focal-operations-and-functions-1"><i class="fa fa-check"></i>Focal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#zonal-operations-and-functions-1"><i class="fa fa-check"></i>Zonal operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#global-operations-and-functions-1"><i class="fa fa-check"></i>Global operations and functions</a></li>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#computing-cumulative-distances"><i class="fa fa-check"></i>Computing cumulative distances</a><ul>
<li class="chapter" data-level="" data-path="raster-operations-in-r.html"><a href="raster-operations-in-r.html#working-example"><i class="fa fa-check"></i>Working example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html"><i class="fa fa-check"></i>Point pattern analysis in R</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#density-based-analysis-1"><i class="fa fa-check"></i>Density based analysis</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#quadrat-density-1"><i class="fa fa-check"></i>Quadrat density</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#quadrat-density-on-a-tesselated-surface"><i class="fa fa-check"></i>Quadrat density on a tesselated surface</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#kernel-density-raster"><i class="fa fa-check"></i>Kernel density raster</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#kernel-density-adjusted-for-covariate-1"><i class="fa fa-check"></i>Kernel Density Adjusted for Covariate</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#modeling-intensity-as-a-function-of-a-covariate-1"><i class="fa fa-check"></i>Modeling intensity as a function of a covariate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#distance-based-analysis-1"><i class="fa fa-check"></i>Distance based analysis</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#average-nearest-neighbor-analysis"><i class="fa fa-check"></i>Average nearest neighbor analysis</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#k-and-l-functions-1"><i class="fa fa-check"></i>K and L functions</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#the-pair-correlation-function-g-1"><i class="fa fa-check"></i>The Pair Correlation Function g</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#hypothesis-tests"><i class="fa fa-check"></i>Hypothesis tests</a><ul>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#test-for-clustering"><i class="fa fa-check"></i>Test for clustering</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#computing-a-pseudo-p-value"><i class="fa fa-check"></i>Computing a pseudo p-value</a></li>
<li class="chapter" data-level="" data-path="point-pattern-analysis-in-r.html"><a href="point-pattern-analysis-in-r.html#testing-for-a-covariate-effect"><i class="fa fa-check"></i>Testing for a covariate effect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html"><i class="fa fa-check"></i>Spatial Autocorrelation in R</a><ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#define-neighboring-polygons"><i class="fa fa-check"></i>Define neighboring polygons</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#computing-the-morans-i-statistic-the-hard-way"><i class="fa fa-check"></i>Computing the Moran’s I statistic: the hard way</a><ul>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#computing-a-pseudo-p-value-from-an-mc-simulation"><i class="fa fa-check"></i>Computing a pseudo p-value from an MC simulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#computing-the-morans-i-statistic-the-easy-way"><i class="fa fa-check"></i>Computing the Moran’s I statistic: the easy way</a></li>
<li class="chapter" data-level="" data-path="spatial-autocorrelation-in-r.html"><a href="spatial-autocorrelation-in-r.html#morans-i-as-a-function-of-a-distance-band"><i class="fa fa-check"></i>Moran’s I as a function of a distance band</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html"><i class="fa fa-check"></i>Interpolation in R</a><ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#thiessen-polygons"><i class="fa fa-check"></i>Thiessen polygons</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#idw"><i class="fa fa-check"></i>IDW</a><ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fine-tuning-the-interpolation"><i class="fa fa-check"></i>Fine-tuning the interpolation</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#cross-validation"><i class="fa fa-check"></i>Cross-validation</a></li>
</ul></li>
<li><a href="interpolation-in-r.html#st-order-polynomial-fit">1<sup>st</sup> order polynomial fit</a></li>
<li><a href="interpolation-in-r.html#nd-order-polynomial">2<sup>nd</sup> order polynomial</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#kriging"><i class="fa fa-check"></i>Kriging</a><ul>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#fit-the-variogram-model"><i class="fa fa-check"></i>Fit the variogram model</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-kriged-surface"><i class="fa fa-check"></i>Generate Kriged surface</a></li>
<li class="chapter" data-level="" data-path="interpolation-in-r.html"><a href="interpolation-in-r.html#generate-the-variance-and-confidence-interval-maps"><i class="fa fa-check"></i>Generate the variance and confidence interval maps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html"><i class="fa fa-check"></i>Mapping rates in R</a><ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#raw-rates"><i class="fa fa-check"></i>Raw Rates</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#standardized-mortality-ratios-relative-risk."><i class="fa fa-check"></i>Standardized mortality ratios (relative risk).</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#dykes-and-unwins-chi-square-statistic"><i class="fa fa-check"></i>Dykes and Unwin’s chi-square statistic</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#unstable-ratios"><i class="fa fa-check"></i>Unstable ratios</a><ul>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#global-empirical-bayes-eb-rate-estimate"><i class="fa fa-check"></i>Global Empirical Bayes (EB) rate estimate</a></li>
<li class="chapter" data-level="" data-path="mapping-rates-in-r.html"><a href="mapping-rates-in-r.html#local-empirical-bayes-eb-rate-estimate"><i class="fa fa-check"></i>Local Empirical Bayes (EB) rate estimate</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Intro to GIS and Spatial Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="coordinate-systems-in-r" class="section level1 unnumbered">
<h1>Coordinate Systems in R</h1>
<p>For this exercise, we’ll load a sample shapefile into our current working directory (you might want to create a temporary folder for this exercise and set it as the working directory via the <strong>Session &gt;&gt; Set Working Directory &gt;&gt; Choose Directory</strong> pull-down menu from the RStudio interface).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tmp &lt;-<span class="st"> </span><span class="kw">tempfile</span>()
<span class="kw">download.file</span>(<span class="st">&quot;http://colby.edu/~mgimond/Spatial/Data/Income_schooling.zip&quot;</span>, 
              <span class="dt">destfile =</span> tmp)
<span class="kw">unzip</span>(tmp, <span class="dt">exdir =</span> <span class="st">&quot;.&quot;</span>)</code></pre></div>
<p>Next, we’ll convert the shapefile into an R spatial object using <code>readOGR</code> (note that <code>maptools</code> could also be used to create an R spatial object but unlike <code>readOGR</code> it will not load the GIS file’s coordinate system).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rgdal)
s1 &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="st">&quot;.&quot;</span>, <span class="st">&quot;Income_schooling&quot;</span>) <span class="co"># CS is read and stored</span></code></pre></div>
<pre><code>OGR data source with driver: ESRI Shapefile 
Source: &quot;C:\Users\mgimond\Documents\Github\Spatial&quot;, layer: &quot;Income_schooling&quot;
with 16 features
It has 5 fields</code></pre>
<div id="checking-for-a-coordinate-system" class="section level2 unnumbered">
<h2>Checking for a coordinate system</h2>
<p>The <code>summary</code> function can be used to pull the coordinate system information (if present) but to extract just the coordinate system information, use <code>proj4string</code> instead–it’s part of the <code>sp</code> package that was automatically loaded with the <code>rgdal</code> package in an earlier step.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">proj4string</span>(s1)</code></pre></div>
<pre><code>[1] &quot;+proj=utm +zone=19 +datum=NAD83 +units=m +no_defs +ellps=GRS80 +towgs84=0,0,0&quot;</code></pre>
<p>Object <code>s1</code> has a CS. It’s made up of a multi-parameter string whose syntax is briefly discussed next.</p>
</div>
<div id="understanding-the-coordinate-syntax" class="section level2 unnumbered">
<h2>Understanding the coordinate syntax</h2>
<p>Coordinate systems are defined in R using a syntax created by the <a href="http://proj4.org/">PROJ4</a> project. It consists of a list of parameters, each prefixed with the <code>+</code> character. For example, <code>s1</code>’s CS is in a UTM projection (<code>+proj=utm</code>) for zone 19 (<code>+zone=19</code>) and an NAD 1983 datum (<code>+datum=NAD83</code>). Other bits of information that can be gleaned from the projection string are the units (in meters) and the ellipsoid (GRS80).</p>
<p>A list of a subset of PROJ4 parameters used in defining a CS follows. Click <a href="http://proj4.org/parameters.html">here</a> for a full list of parameters.</p>
<pre><code>+a         Semimajor radius of the ellipsoid axis
+b         Semiminor radius of the ellipsoid axis
+datum     Datum name (see `proj -ld`)
+ellps     Ellipsoid name (see `proj -le`)
+lat_0     Latitude of origin
+lat_1     Latitude of first standard parallel
+lat_2     Latitude of second standard parallel
+lat_ts    Latitude of true scale
+lon_0     Central meridian
+over      Allow longitude output outside -180 to 180 range, disables wrapping (see below)
+proj      Projection name (see `proj -l`)
+south     Denotes southern hemisphere UTM zone
+units     meters, US survey feet, etc.
+x_0       False easting
+y_0       False northing
+zone      UTM zone</code></pre>
</div>
<div id="assigning-a-coordinate-system" class="section level2 unnumbered">
<h2>Assigning a coordinate system</h2>
<p>A CS definition can be passed to a spatial object. It can either fill a spatial object’s empty CS definition or it can overwrite and existing definition (the latter should only be executed if there is good reason to believe that the original definition is erroneous). Note that this step <strong>does not</strong> change an objects underlying coordinate system (this option will be discussed in the next section).</p>
<p>We’ll pretend that a CS definition was not assigned to <code>s1</code> and assign one manually.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">proj4string</span>(s1) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">&quot;+proj=utm +zone=19 +ellps=GRS80 +datum=NAD83&quot;</span>)</code></pre></div>
<p>Note that we do not need to define all of the parameters so long as we know that the default values for these unused parameters are correct. Also note that we do not need to designate a hemisphere since the NAD83 datum applies only to North America.</p>
<p>To recreate a CS defined in a piece of software such as ArcGIS, it is best to extract the CS’ <strong>WKID/EPSG</strong> code then use that number to lookup the PROJ4 syntax on <a href="http://spatialreference.org/ref/" class="uri">http://spatialreference.org/ref/</a>. For example, in ArcGIS, the WKID number can be extracted from the coordinate system properties output.</p>
<div class="figure" style="text-align: center"><span id="fig:fA2-arcgis"></span>
<img src="img/ArcGIS_UTMNAD83.jpg" alt="An ArcGIS dataframe coordinate system properties window. Note the WKID/EPSG code of 26919 (highlighted in red) associated with the NAD 1983 UTM Zone 19 N CS." width="471" />
<p class="caption">
Figure 14.19: An ArcGIS dataframe coordinate system properties window. Note the WKID/EPSG code of 26919 (highlighted in red) associated with the NAD 1983 UTM Zone 19 N CS.
</p>
</div>
<p>That number can then be entered in <a href="http://spatialreference.org/ref/" class="uri">http://spatialreference.org/ref/</a>’s search box to pull the Proj4 parameters (note that you must select <strong>Proj4</strong> from the list of syntax options).</p>
<div class="figure" style="text-align: center"><span id="fig:fA2-epsg"></span>
<img src="img/EPSG_search.jpg" alt="Example of a search result for EPSG **26919** at [http://spatialreference.org/ref/](http://spatialreference.org/ref/). Note that after clicking the `EPSG:269191` link, you must then select the Proj4 syntax from a list of available syntaxes to view the projection parameters" width="420" />
<p class="caption">
Figure 14.20: Example of a search result for EPSG <strong>26919</strong> at <a href="http://spatialreference.org/ref/" class="uri">http://spatialreference.org/ref/</a>. Note that after clicking the <code>EPSG:269191</code> link, you must then select the Proj4 syntax from a list of available syntaxes to view the projection parameters
</p>
</div>
<p>Here are examples of a few common projections:</p>
<table>
<thead>
<tr class="header">
<th align="left">Projection</th>
<th align="center">WKID</th>
<th align="center">Authority</th>
<th align="center">Syntax</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">UTM NAD 83 Zone 19N</td>
<td align="center">26919</td>
<td align="center">EPSG</td>
<td align="center"><code>+proj=utm +zone=19 +ellps=GRS80 +datum=NAD83 +units=m +no_defs</code></td>
</tr>
<tr class="even">
<td align="left">USA Contiguous albers equal area</td>
<td align="center">102003</td>
<td align="center">ESRI</td>
<td align="center"><code>+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs</code></td>
</tr>
<tr class="odd">
<td align="left">Alaska albers equal area</td>
<td align="center">3338</td>
<td align="center">EPSG</td>
<td align="center"><code>+proj=aea +lat_1=55 +lat_2=65 +lat_0=50 +lon_0=-154 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs</code></td>
</tr>
<tr class="even">
<td align="left">World Robinson</td>
<td align="center">54030</td>
<td align="center">ESRI</td>
<td align="center"><code>+proj=robin +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs</code></td>
</tr>
</tbody>
</table>
</div>
<div id="modifying-coordinate-systems" class="section level2 unnumbered">
<h2>Modifying coordinate systems</h2>
<p>The last step showed you how to define or modify the coordinate system definition. This section shows you how to <strong>transform</strong> the coordinate values associated with the spatial object to a <em>different</em> coordinate system. For example, to transform <code>s1</code> to a geographic (lat/long) coordinate system use the <code>spTransform</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s1.gcs &lt;-<span class="st"> </span><span class="kw">spTransform</span>(s1, <span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>))</code></pre></div>
<p>Let’s explore <code>s1.gcs</code>’s summary.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(s1.gcs)</code></pre></div>
<pre><code>Object of class SpatialPolygonsDataFrame
Coordinates:
        min       max
x -71.08751 -66.96927
y  43.09105  47.45333
Is projected: FALSE 
proj4string :
[+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0]
Data attributes:
           NAME        Income         NoSchool          NoSchoolSE       
 Androscoggin: 1   Min.   :20015   Min.   :0.002390   Min.   :0.0006832  
 Aroostook   : 1   1st Qu.:21631   1st Qu.:0.004907   1st Qu.:0.0009130  
 Cumberland  : 1   Median :23788   Median :0.005252   Median :0.0010281  
 Franklin    : 1   Mean   :24716   Mean   :0.005778   Mean   :0.0011658  
 Hancock     : 1   3rd Qu.:27897   3rd Qu.:0.006603   3rd Qu.:0.0013404  
 Kennebec    : 1   Max.   :32549   Max.   :0.013387   Max.   :0.0021290  
 (Other)     :10                                                         
    IncomeSE    
 Min.   :242.4  
 1st Qu.:342.6  
 Median :455.8  
 Mean   :458.8  
 3rd Qu.:551.5  
 Max.   :724.2  
                </code></pre>
<p>Note the new coordinate system definition, but also note the new min and max extent values have changed to reflect the new CS units (degrees latitude and longitude). You’ll also note the <code>Is projected: FALSE</code> output that reminds us that a geographic coordinate system is a not a projected coordinate system (i.e. projected onto a cartesian coordinate system).</p>
<p>A geographic coordinate system is often desired when overlapping a web based mapping service such as Google, Bing or OpenStreetMap. To check that <code>s1.gcs</code> was properly transformed, we’ll overlay it on top of an OpenStreetMap using the <code>leaflet</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(leaflet)
<span class="kw">leaflet</span>(s1.gcs) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addPolygons</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addTiles</span>()</code></pre></div>
<div id="htmlwidget-fd59e977994bb979b5ab" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-fd59e977994bb979b5ab">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addPolygons","args":[[[[{"lng":[-68.8202158959377,-68.8198428550497,-69.7172113864081,-70.0141447324675,-69.9849775559489,-69.2302960504507,-69.0469764226522,-69.0367145086766,-68.8948719922674,-68.5146730293485,-68.3912568471377,-68.3348137559721,-68.230806786,-67.7910107465827,-67.7802895897975,-67.7556150667948,-67.7945708237807,-67.7593671297629,-67.8030534244138,-67.8034327853946,-68.0442673817386,-68.257750377734,-68.2572772514418,-68.4078325338314,-68.4341625067183,-68.4319133825422,-68.4224909530257,-68.4387400670549,-68.4362514010004,-68.6938938179389,-68.694252612716,-68.8202158959377],"lat":[46.3975029038531,46.5705359589532,46.5717152261069,46.5705982792127,46.6913656690831,47.4533345006126,47.4220306664875,47.2573616325743,47.1822564988308,47.2969643184046,47.2850971526591,47.3573740966737,47.3521482087837,47.0610036015027,45.9470627402573,45.9165802073734,45.8784756943635,45.8277986000031,45.7945081327697,45.678113625476,45.6357807631594,45.6042463492548,45.594606809009,45.5720630897562,45.5845974397256,45.7599446848754,45.7710111673874,46.0930094834948,46.3810145069658,46.3848470216072,46.3967944836138,46.3975029038531]}]],[[{"lng":[-70.5522701227431,-70.3963831168109,-70.4162139103225,-70.2539641250507,-70.2474646866552,-70.3102952676871,-70.280022592967,-70.3048496270618,-70.2293253986393,-70.2834966236555,-70.1910584799657,-70.0466075265629,-70.0141447324675,-69.7172113864081,-69.7289361428492,-69.6834566513734,-69.6495652572825,-69.6752689193327,-69.7052760983507,-69.7206418498994,-69.7029409794692,-69.7193747748989,-69.7086322748495,-69.7304828042506,-69.7265610312492,-69.7650747961707,-69.7782284116275,-69.7939298015476,-69.7913890724336,-69.8119659995252,-69.7944713609759,-69.7784568156373,-69.7356779723452,-69.7394239742408,-69.6972404629698,-69.6985985058636,-69.7105691760799,-69.6957525991533,-69.7110878899268,-69.708417443498,-69.7775637658015,-69.6975434647965,-69.7067752036439,-69.649056075379,-69.6412510197776,-69.6070545516986,-69.4896050033377,-69.4937861591645,-69.3522667963532,-69.272746818761,-69.2827413720891,-69.2657354010438,-69.3240541092611,-69.34466947495,-69.3827629018954,-69.3955572045347,-69.4028421993842,-69.4624731039204,-69.4789760059387,-69.6255230025811,-69.6158402577664,-69.5767153087878,-69.5789425716592,-69.6025020127131,-69.7786921613885,-69.7984447826045,-69.8167637270293,-69.8233181813147,-69.8521814235339,-69.9216111657372,-69.9415176967544,-69.9738221777052,-69.958471449328,-69.9603562874987,-69.9966047653838,-70.0161687162882,-70.0031070530014,-70.0191980092982,-70.0296198941475,-70.0317562409298,-70.0239360067448,-70.0317259355667,-70.1295972351082,-70.136685478216,-70.1476796422889,-70.1516776708363,-70.1420187040757,-70.144551921604,-70.1074724551224,-70.1553480906383,-70.2900544452034,-70.3085022262742,-70.3631059114116,-70.3603211852718,-70.4176409561967,-70.5247769937588,-70.5104105421308,-70.5522701227431],"lat":[45.6606641600491,45.7220459893141,45.7903090009413,45.8990048581307,45.9446197653656,45.9687822572426,46.053154045756,46.0666583227557,46.1374344001399,46.1902492399916,46.3348397534767,46.4261155181296,46.5705982792127,46.5717152261069,45.9728200712922,45.9768793322142,45.8640350075469,45.8511147692878,45.8827532057036,45.8777445321509,45.8378016491936,45.826411184219,45.8105004023713,45.7754783851199,45.7552074644893,45.7555012451969,45.7746849026479,45.7536548974275,45.7421308816391,45.7368170304901,45.7243737520221,45.6886267890428,45.6740090360195,45.6562785854827,45.6531084372895,45.6421680458095,45.6384297109118,45.6155303569284,45.6100716616851,45.5806950932391,45.5380285611045,45.2948927775248,45.2924438969727,45.1026815562019,45.1033414360562,45.0131027364687,45.0306879284789,45.0550517308531,45.0730857012569,44.8066218852675,44.8019450165874,44.7232306436125,44.7170578296856,44.7538610252249,44.7519875321388,44.7437477888425,44.7028853841853,44.6957893704716,44.7182725826063,44.6998506517512,44.6607202633484,44.6302072178852,44.6060796937349,44.5794610687403,44.6047777546158,44.5761869498399,44.5808673929988,44.6098355902019,44.6207756708577,44.6087628839574,44.6408703541462,44.6591954632516,44.6687740819471,44.6802446359667,44.6758574554751,44.7581767161421,44.7614421837678,44.8158123362954,44.8138362712112,44.8321695135509,44.8337640936887,44.8655134425529,44.8555833334499,44.9005505865839,44.8999516282799,44.920169346162,44.9198908994501,44.9432595462267,44.9485849496765,45.126798305112,45.1123024469935,45.1649104851198,45.1604547160799,45.1521540512333,45.1450127607892,45.5126513681109,45.5136548123547,45.6606641600491]}]],[[{"lng":[-69.7172113864081,-68.8198428550497,-68.8202158959377,-68.8259919945306,-68.9522087549172,-68.9662604970057,-68.858461523151,-68.7750422555106,-68.8727778284688,-68.8532621071251,-69.3522667963532,-69.4937861591645,-69.4896050033377,-69.6070545516986,-69.6412510197776,-69.649056075379,-69.7067752036439,-69.6975434647965,-69.7775637658015,-69.708417443498,-69.7110878899268,-69.6957525991533,-69.7105691760799,-69.6985985058636,-69.6972404629698,-69.7394239742408,-69.7356779723452,-69.7784568156373,-69.7944713609759,-69.8119659995252,-69.7913890724336,-69.7939298015476,-69.7782284116275,-69.7650747961707,-69.7265610312492,-69.7304828042506,-69.7086322748495,-69.7193747748989,-69.7029409794692,-69.7206418498994,-69.7052760983507,-69.6752689193327,-69.6495652572825,-69.6834566513734,-69.7289361428492,-69.7172113864081],"lat":[46.5717152261069,46.5705359589532,46.3975029038531,45.6844204564528,45.663995574217,45.5125268830041,45.5258563731748,45.2439624650197,45.2294245420211,45.1458950871889,45.0730857012569,45.0550517308531,45.0306879284789,45.0131027364687,45.1033414360562,45.1026815562019,45.2924438969727,45.2948927775248,45.5380285611045,45.5806950932391,45.6100716616851,45.6155303569284,45.6384297109118,45.6421680458095,45.6531084372895,45.6562785854827,45.6740090360195,45.6886267890428,45.7243737520221,45.7368170304901,45.7421308816391,45.7536548974275,45.7746849026479,45.7555012451969,45.7552074644893,45.7754783851199,45.8105004023713,45.826411184219,45.8378016491936,45.8777445321509,45.8827532057036,45.8511147692878,45.8640350075469,45.9768793322142,45.9728200712922,46.5717152261069]}]],[[{"lng":[-69.3522667963532,-68.8532621071251,-68.8727778284688,-68.7750422555106,-68.858461523151,-68.9662604970057,-68.9522087549172,-68.8259919945306,-68.8202158959377,-68.694252612716,-68.6938938179389,-68.4362514010004,-68.4387400670549,-68.4224909530257,-68.4319133825422,-68.4341625067183,-68.4078325338314,-68.2572772514418,-68.257750377734,-68.0442673817386,-67.9374017094583,-68.0501369866226,-68.3005641369487,-68.2753564985761,-68.394538736644,-68.3763047508439,-68.4996991235541,-68.4451095291154,-68.6053095321548,-68.6494463147326,-68.6842837023874,-68.7181055754573,-68.7439616967955,-68.7663622296832,-68.7656147491982,-68.7962935157835,-68.8240041181253,-68.8318934588989,-68.8628237858996,-68.8919760946589,-68.8974313708356,-69.1800227685777,-69.20874292804,-69.2657354010438,-69.2827413720891,-69.272746818761,-69.3522667963532],"lat":[45.0730857012569,45.1458950871889,45.2294245420211,45.2439624650197,45.5258563731748,45.5125268830041,45.663995574217,45.6844204564528,46.3975029038531,46.3967944836138,46.3848470216072,46.3810145069658,46.0930094834948,45.7710111673874,45.7599446848754,45.5845974397256,45.5720630897562,45.594606809009,45.6042463492548,45.6357807631594,45.2683404617007,45.2559714702251,45.225625285573,45.1033141871315,45.0868371353288,44.9955238127473,44.9800582866187,44.7652354827514,44.7429960086223,44.7059329122171,44.7210274178153,44.6999819749911,44.6653601957484,44.6666990193435,44.6762623558473,44.6870575924088,44.6863059676007,44.7007748358147,44.7001375943256,44.6889223824163,44.6932405081234,44.6443454209155,44.7285108739399,44.7232306436125,44.8019450165874,44.8066218852675,45.0730857012569]}]],[[{"lng":[-67.1506607561156,-67.0653586188579,-67.1467066573937,-66.969271036002,-67.0077187507732,-67.2003646079872,-67.3084681377898,-67.3885104555116,-67.5709936034853,-67.6188382601856,-67.8112189325215,-67.8585605201949,-67.9000417759072,-67.9683422418549,-67.9634367619487,-67.986523698359,-68.0112605416211,-67.9949024836971,-68.0143975870331,-68.0319000997964,-68.0948005644774,-67.9798366257326,-68.0501369866226,-67.9374017094583,-68.0442673817386,-67.8034327853946,-67.75295518839,-67.7180346034478,-67.6151403324387,-67.4393007416981,-67.4160842433853,-67.5041066625577,-67.4185550888501,-67.4779500777908,-67.4394348623562,-67.3456056765996,-67.2740952251524,-67.1659056488403,-67.1506607561156],"lat":[45.1219899059758,44.9592956420457,44.904581199872,44.8286551275156,44.7806250123542,44.6537812158742,44.6535210559882,44.6914002214265,44.5983332285021,44.5402396088361,44.5540098477743,44.5360772060716,44.4523993326664,44.4712283914674,44.5053274161483,44.4848123430798,44.5883644735857,44.5917442727265,44.6762575380716,44.6747582773664,44.9408935003337,44.9554474307804,45.2559714702251,45.2683404617007,45.6357807631594,45.678113625476,45.6592891772344,45.6812994702931,45.6051989219319,45.59256143012,45.5035545269822,45.4858159950153,45.3758523375688,45.2802804121216,45.1895839720417,45.1222522416315,45.1827832931569,45.1562643909382,45.1219899059758]}]],[[{"lng":[-70.8428755535817,-70.8126658207695,-70.8291320455279,-70.7969669174432,-70.6349296323412,-70.7199105845544,-70.5522701227431,-70.5104105421308,-70.5247769937588,-70.4176409561967,-70.3603211852718,-70.3631059114116,-70.3085022262742,-70.2900544452034,-70.1553480906383,-70.1074724551224,-70.144551921604,-70.1420187040757,-70.1516776708363,-70.1476796422889,-70.136685478216,-70.1295972351082,-70.0317259355667,-70.0239360067448,-70.0317562409298,-70.0296198941475,-70.0191980092982,-70.0031070530014,-70.0161687162882,-69.9966047653838,-69.9603562874987,-69.958471449328,-69.9738221777052,-69.9415176967544,-69.9216111657372,-69.9510762154826,-70.0286924982336,-70.0678307090463,-70.0281184576726,-70.041103399177,-70.1244255860475,-70.1991415678468,-70.231269345219,-70.2472614594085,-70.2713022117928,-70.282861506132,-70.3040409660062,-70.2810081130132,-70.5435626925789,-70.5126784193691,-70.621690073983,-70.7705036527628,-70.7792539248677,-70.7964349417622,-70.8073832592603,-70.8239232011668,-70.7842192902435,-70.8428755535817],"lat":[45.2781374344223,45.3546780062945,45.390726157959,45.425172166096,45.3919670201156,45.5129543699375,45.6606641600491,45.5136548123547,45.5126513681109,45.1450127607892,45.1521540512333,45.1604547160799,45.1649104851198,45.1123024469935,45.126798305112,44.9485849496765,44.9432595462267,44.9198908994501,44.920169346162,44.8999516282799,44.9005505865839,44.8555833334499,44.8655134425529,44.8337640936887,44.8321695135509,44.8138362712112,44.8158123362954,44.7614421837678,44.7581767161421,44.6758574554751,44.6802446359667,44.6687740819471,44.6591954632516,44.6408703541462,44.6087628839574,44.5777040311348,44.5891626184213,44.5341786916345,44.5115505836015,44.486835705252,44.4865416655242,44.4795682719719,44.4663314592278,44.5014677561902,44.5071592069827,44.5417080461379,44.5413838564591,44.5754328902419,44.6098681231387,44.6236694445005,44.7930913436198,44.7360427150373,44.8490243722131,44.9211284461481,44.9213914552563,45.0081057188249,45.0149269121093,45.2781374344223]}]],[[{"lng":[-71.00859652032,-71.0287261195311,-71.087509250962,-70.9593819057968,-70.8764440530948,-70.8428755535817,-70.7842192902435,-70.8239232011668,-70.8073832592603,-70.7964349417622,-70.7792539248677,-70.7705036527628,-70.621690073983,-70.5126784193691,-70.5435626925789,-70.2810081130132,-70.3040409660062,-70.282861506132,-70.2713022117928,-70.2472614594085,-70.231269345219,-70.2727964993103,-70.2603743050863,-70.3190657951714,-70.481373238339,-70.5438391707373,-70.6084839810342,-70.5888726294337,-70.6105822518475,-70.6227513315348,-70.8220499671009,-70.8602592796827,-70.8726573850283,-70.8513011697716,-70.8482491865923,-70.804149806531,-70.7185841421247,-70.7468583724156,-70.7318202296123,-70.7539614314786,-70.7555404186005,-70.7771165938088,-70.800547768061,-70.7841356267198,-70.9104967649645,-70.9415338082865,-70.9844425761095,-71.00859652032],"lat":[44.2821463413425,44.6685381145474,45.3014691967229,45.3388657557299,45.2254453701441,45.2781374344223,45.0149269121093,45.0081057188249,44.9213914552563,44.9211284461481,44.8490243722131,44.7360427150373,44.7930913436198,44.6236694445005,44.6098681231387,44.5754328902419,44.5413838564591,44.5417080461379,44.5071592069827,44.5014677561902,44.4663314592278,44.4451413277215,44.3685974403908,44.2183359905128,44.0345038135482,44.009081240216,44.05702007666,44.1216648869569,44.1567737795825,44.1684809226502,44.0790261735915,44.0927013003132,44.0861552382823,44.066045065586,44.0495659416218,44.0382358283531,43.9666552860406,43.9468421059024,43.9291539792659,43.9046327962199,43.8714044938338,43.8714804903597,43.8592884096788,43.8169700524933,43.7999334652607,43.7865326927318,43.7911635594249,44.2821463413425]}]],[[{"lng":[-69.4146409319936,-69.5047286746101,-69.4402439905991,-69.3925757266531,-69.3687576280303,-69.4138931406844,-69.4016350098532,-69.460900074263,-69.4327713097148,-69.4735046187058,-69.4728642689743,-69.4624731039204,-69.4028421993842,-69.3955572045347,-69.3827629018954,-69.34466947495,-69.3240541092611,-69.2657354010438,-69.20874292804,-69.1800227685777,-68.8974313708356,-68.8919760946589,-68.8628237858996,-68.8318934588989,-68.8240041181253,-68.8238128576118,-68.8606089041936,-68.8079028528248,-68.8116777613743,-68.9591794546594,-68.9850277535877,-69.0214822561375,-69.0391830747638,-69.1306479241606,-69.2638687978949,-69.3454959565951,-69.392408762234,-69.4146409319936],"lat":[44.3307536571113,44.34158194465,44.4635360614559,44.4577920295634,44.5437052990743,44.5498308677172,44.6357097911499,44.6427621858623,44.6692017760966,44.675155873369,44.6943167370426,44.6957893704716,44.7028853841853,44.7437477888425,44.7519875321388,44.7538610252249,44.7170578296856,44.7232306436125,44.7285108739399,44.6443454209155,44.6932405081234,44.6889223824163,44.7001375943256,44.7007748358147,44.6863059676007,44.6640894944651,44.6109704094898,44.5696542014471,44.4945934637654,44.4303318479482,44.2711125989834,44.2440933215478,44.2524778053302,44.2599653539739,44.3651790990447,44.3132952295857,44.3473284631364,44.3307536571113]}]],[[{"lng":[-70.1244255860475,-70.041103399177,-70.0281184576726,-70.0678307090463,-70.0286924982336,-69.9510762154826,-69.9216111657372,-69.8521814235339,-69.8233181813147,-69.8167637270293,-69.7984447826045,-69.7786921613885,-69.6025020127131,-69.5789425716592,-69.5767153087878,-69.6158402577664,-69.6255230025811,-69.4789760059387,-69.4624731039204,-69.4728642689743,-69.4735046187058,-69.4327713097148,-69.460900074263,-69.4016350098532,-69.4138931406844,-69.3687576280303,-69.3925757266531,-69.4402439905991,-69.5047286746101,-69.521803804048,-69.5437918731738,-69.645484238664,-69.6663049037611,-69.655953006169,-69.7501220264243,-69.7554626084577,-69.8539836860659,-69.8748813319655,-69.8959241327837,-69.9989009276277,-70.0227277811331,-70.0206829202845,-70.010467008296,-70.0063240320463,-69.9975424703016,-69.9931324442286,-70.0745241535695,-70.0735558324644,-70.1206163832238,-70.1014359376233,-70.1244255860475],"lat":[44.4865416655242,44.486835705252,44.5115505836015,44.5341786916345,44.5891626184213,44.5777040311348,44.6087628839574,44.6207756708577,44.6098355902019,44.5808673929988,44.5761869498399,44.6047777546158,44.5794610687403,44.6060796937349,44.6302072178852,44.6607202633484,44.6998506517512,44.7182725826063,44.6957893704716,44.6943167370426,44.675155873369,44.6692017760966,44.6427621858623,44.6357097911499,44.5498308677172,44.5437052990743,44.4577920295634,44.4635360614559,44.34158194465,44.2864872090229,44.2630422030921,44.2810075331436,44.2351516335172,44.1276148917102,44.1406935467219,44.1572870022011,44.1731715712048,44.1546672201229,44.1124437161336,44.1279011608321,44.1345459613622,44.1586541626059,44.158806777306,44.1751027221868,44.172558418594,44.1824572380572,44.2090598037996,44.2920502894056,44.3741786003833,44.3850274023216,44.4865416655242]}]],[[{"lng":[-69.9989009276277,-70.0184711986249,-70.0327993670678,-70.0213172089434,-70.0378041553176,-70.0340425604062,-70.072700029733,-70.0894620555566,-70.1109918661495,-70.1949849153306,-70.1905371759169,-70.3102828347177,-70.3631700966165,-70.3885841740862,-70.401722092919,-70.4641012017472,-70.481373238339,-70.3190657951714,-70.2603743050863,-70.2727964993103,-70.231269345219,-70.1991415678468,-70.1244255860475,-70.1014359376233,-70.1206163832238,-70.0735558324644,-70.0745241535695,-69.9931324442286,-69.9975424703016,-70.0063240320463,-70.010467008296,-70.0206829202845,-70.0227277811331,-69.9989009276277],"lat":[44.1279011608321,44.044128900467,44.0276878524718,44.0063683144749,43.9854373067738,43.9734708844888,43.9317688917644,43.9386463960397,43.917852617239,43.949924757073,43.9611931717307,44.0393420000071,43.9906553204499,44.0032013781322,43.995354568475,44.0189170141632,44.0345038135482,44.2183359905128,44.3685974403908,44.4451413277215,44.4663314592278,44.4795682719719,44.4865416655242,44.3850274023216,44.3741786003833,44.2920502894056,44.2090598037996,44.1824572380572,44.172558418594,44.1751027221868,44.158806777306,44.1586541626059,44.1345459613622,44.1279011608321]}]],[[{"lng":[-68.0501369866226,-67.9798366257326,-68.0948005644774,-68.0319000997964,-68.0143975870331,-67.9949024836971,-68.0112605416211,-67.986523698359,-68.016392975024,-68.0743791531122,-68.1362647248567,-68.2456142454157,-68.3637657385109,-68.4285712449382,-68.5521861992483,-68.5300756653733,-68.5594267980359,-68.7403098746437,-68.8128516927119,-68.8137677435412,-68.7413487010464,-68.7452790217143,-68.8235520760772,-68.8238128576118,-68.8240041181253,-68.7962935157835,-68.7656147491982,-68.7663622296832,-68.7439616967955,-68.7181055754573,-68.6842837023874,-68.6494463147326,-68.6053095321548,-68.4451095291154,-68.4996991235541,-68.3763047508439,-68.394538736644,-68.2753564985761,-68.3005641369487,-68.0501369866226],"lat":[45.2559714702251,44.9554474307804,44.9408935003337,44.6747582773664,44.6762575380716,44.5917442727265,44.5883644735857,44.4848123430798,44.3849565861997,44.3813743886768,44.475237143451,44.490648016318,44.4313868372113,44.4653064126995,44.3990492534793,44.2898360811521,44.2598872334824,44.3463301474925,44.3274322929271,44.4139901601006,44.5072848835824,44.5523206216564,44.608906847383,44.6640894944651,44.6863059676007,44.6870575924088,44.6762623558473,44.6666990193435,44.6653601957484,44.6999819749911,44.7210274178153,44.7059329122171,44.7429960086223,44.7652354827514,44.9800582866187,44.9955238127473,45.0868371353288,45.1033141871315,45.225625285573,45.2559714702251]}],[{"lng":[-68.3879209778224,-68.3502537427093,-68.3554494806484,-68.2387092331955,-68.1647688096706,-68.3047050928408,-68.3207117121614,-68.4028903248613,-68.3879209778224],"lat":[44.3772530665156,44.3989509294124,44.4288577640061,44.437563329225,44.3344957218999,44.2900314341848,44.2250794777381,44.2708014639226,44.3772530665156]}]],[[{"lng":[-69.3464537614802,-69.3286010016063,-69.2825031771158,-69.3018433863739,-69.2975703819852,-69.3327483293953,-69.4033812204145,-69.4078519090177,-69.4388193795147,-69.4443346965731,-69.4401384139668,-69.4186617025143,-69.4146409319936,-69.392408762234,-69.3454959565951,-69.2638687978949,-69.1306479241606,-69.0391830747638,-69.0214822561375,-69.074458413768,-69.219140724011,-69.2936504739293,-69.3464537614802],"lat":[44.0159695715356,44.0111327837857,44.0701680454765,44.0945737055146,44.1286344470103,44.2106289999581,44.2140039295192,44.2232847785959,44.2375813983788,44.3075832125896,44.3225022061022,44.3185658761658,44.3307536571113,44.3473284631364,44.3132952295857,44.3651790990447,44.2599653539739,44.2524778053302,44.2440933215478,44.0690660181456,43.9467875562489,43.9421907766137,44.0159695715356]}]],[[{"lng":[-69.8000128390742,-69.7667552156018,-69.7772762533827,-69.7501220264243,-69.655953006169,-69.6663049037611,-69.645484238664,-69.5437918731738,-69.521803804048,-69.5047286746101,-69.4146409319936,-69.4186617025143,-69.4401384139668,-69.4443346965731,-69.4388193795147,-69.4078519090177,-69.4033812204145,-69.3327483293953,-69.2975703819852,-69.3018433863739,-69.2825031771158,-69.3286010016063,-69.3464537614802,-69.3944884353971,-69.4832330546832,-69.5893265359517,-69.6644528575473,-69.6552447931459,-69.6129323416209,-69.7206355816107,-69.7047589904291,-69.8000128390742],"lat":[44.0268667066427,44.0477322340379,44.0741483052384,44.1406935467219,44.1276148917102,44.2351516335172,44.2810075331436,44.2630422030921,44.2864872090229,44.34158194465,44.3307536571113,44.3185658761658,44.3225022061022,44.3075832125896,44.2375813983788,44.2232847785959,44.2140039295192,44.2106289999581,44.1286344470103,44.0945737055146,44.0701680454765,44.0111327837857,44.0159695715356,44.0251280594712,43.8871600707793,43.8448627978378,43.8522244626656,43.9802499092851,44.033612835874,43.93797952264,44.0110823784553,44.0268667066427]}]],[[{"lng":[-70.7841356267198,-70.800547768061,-70.7771165938088,-70.7555404186005,-70.7539614314786,-70.7318202296123,-70.7468583724156,-70.7185841421247,-70.804149806531,-70.8482491865923,-70.8513011697716,-70.8726573850283,-70.8602592796827,-70.8220499671009,-70.6227513315348,-70.6105822518475,-70.5888726294337,-70.6084839810342,-70.5438391707373,-70.481373238339,-70.4641012017472,-70.401722092919,-70.3885841740862,-70.3631700966165,-70.3102828347177,-70.1905371759169,-70.1949849153306,-70.1109918661495,-70.0894620555566,-70.072700029733,-70.0340425604062,-70.0296782773,-69.9742338644066,-69.9143113031284,-69.8570440614995,-69.8603320638824,-69.8867908734153,-69.9031321986346,-69.9729033812618,-69.9995000931478,-69.9873704363344,-70.0264027596906,-70.156628531081,-70.2357978471302,-70.2222392276931,-70.341610602309,-70.4927678994408,-70.4656679631159,-70.5551785569291,-70.5723830928575,-70.5966833834794,-70.6068916802742,-70.6211668013807,-70.6501287820991,-70.6466807052343,-70.6643206023102,-70.6965481542624,-70.7541895764683,-70.7777192820035,-70.7841356267198],"lat":[43.8169700524933,43.8592884096788,43.8714804903597,43.8714044938338,43.9046327962199,43.9291539792659,43.9468421059024,43.9666552860406,44.0382358283531,44.0495659416218,44.066045065586,44.0861552382823,44.0927013003132,44.0790261735915,44.1684809226502,44.1567737795825,44.1216648869569,44.05702007666,44.009081240216,44.0345038135482,44.0189170141632,43.995354568475,44.0032013781322,43.9906553204499,44.0393420000071,43.9611931717307,43.949924757073,43.917852617239,43.9386463960397,43.9317688917644,43.9734708844888,43.9610314395196,43.9201504890162,43.9233278897749,43.9557441638428,43.9225610345792,43.8767134235991,43.7907323426006,43.7688475707295,43.7862077777964,43.8457387523406,43.8456010572037,43.7898104897189,43.6857964225933,43.5772404363104,43.5349087136827,43.6109287585666,43.6457372913716,43.7155249994873,43.6881817913931,43.6961007640772,43.6817844587594,43.7003730432094,43.7038441728717,43.7611588151967,43.7893982331731,43.8047862086547,43.7930026546288,43.8049651916109,43.8169700524933]}]],[[{"lng":[-69.8867908734153,-69.8603320638824,-69.8570440614995,-69.9143113031284,-69.9742338644066,-70.0296782773,-70.0340425604062,-70.0378041553176,-70.0213172089434,-70.0327993670678,-70.0184711986249,-69.9989009276277,-69.8959241327837,-69.8748813319655,-69.8539836860659,-69.7554626084577,-69.7501220264243,-69.7772762533827,-69.8599284586111,-69.7915280108674,-69.8303921783115,-69.8517853298484,-69.846155681275,-69.8867908734153],"lat":[43.8767134235991,43.9225610345792,43.9557441638428,43.9233278897749,43.9201504890162,43.9610314395196,43.9734708844888,43.9854373067738,44.0063683144749,44.0276878524718,44.044128900467,44.1279011608321,44.1124437161336,44.1546672201229,44.1731715712048,44.1572870022011,44.1406935467219,44.0741483052384,44.000001079988,43.7560849721624,43.7279862539571,43.7443279936087,43.8423439818324,43.8767134235991]}],[{"lng":[-69.8000128390742,-69.7047589904291,-69.7206355816107,-69.7485283787592,-69.7246713234988,-69.7503594443371,-69.7776729687166,-69.8000128390742],"lat":[44.0268667066427,44.0110823784553,43.93797952264,43.8933754158225,43.7844771602511,43.7617041045157,43.7912707419825,44.0268667066427]}]],[[{"lng":[-70.9642682700125,-70.9496195381735,-70.9565243949817,-70.9738741894367,-70.9844425761095,-70.9415338082865,-70.9104967649645,-70.7841356267198,-70.7777192820035,-70.7541895764683,-70.6965481542624,-70.6643206023102,-70.6466807052343,-70.6501287820991,-70.6211668013807,-70.6068916802742,-70.5966833834794,-70.5723830928575,-70.5551785569291,-70.4656679631159,-70.4927678994408,-70.341610602309,-70.365925605278,-70.45697679942,-70.5389410988088,-70.665672117895,-70.8186681476027,-70.83054816075,-70.8132073801978,-70.9010858877487,-70.9058011432221,-70.9696996127229,-70.9790994556783,-70.9614829222242,-70.9707912274419,-70.9592784013261,-70.9642682700125],"lat":[43.5319898668848,43.5489536176379,43.5641434944728,43.5718299188238,43.7911635594249,43.7865326927318,43.7999334652607,43.8169700524933,43.8049651916109,43.7930026546288,43.8047862086547,43.7893982331731,43.7611588151967,43.7038441728717,43.7003730432094,43.6817844587594,43.6961007640772,43.6881817913931,43.7155249994873,43.6457372913716,43.6109287585666,43.5349087136827,43.4303037178793,43.3494706632996,43.335718193147,43.0910505641212,43.1218710665584,43.1591741192742,43.2352227081839,43.2810200174417,43.3020692937648,43.3663799680073,43.3961839197787,43.4381263868541,43.4702114776979,43.5163879925244,43.5319898668848]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]}],"limits":{"lat":[43.0910505641212,47.4533345006126],"lng":[-71.087509250962,-66.969271036002]}},"evals":[],"jsHooks":[]}</script>
<p>It appears that <code>s1.gcs</code> was properly transformed.</p>
<p>Next, we’ll explore other transformations using a built in dataset of the world from the <code>maptools</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(maptools)
<span class="kw">data</span>(wrld_simpl)

<span class="co"># Let&#39;s check it&#39;s current coordinate system</span>
<span class="kw">proj4string</span>(wrld_simpl)</code></pre></div>
<pre><code>[1] &quot; +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Let&#39;s check its extent</span>
wrld_simpl<span class="op">@</span>bbox</code></pre></div>
<pre><code>   min       max
x -180 180.00000
y  -90  83.57027</code></pre>
<p>The following chunk transforms the worl map to an Azimuthal equidistant projection centered on latitude <code>0</code> and longitude <code>0</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wrld_simpl.ae &lt;-<span class="st"> </span><span class="kw">spTransform</span>(wrld_simpl, <span class="kw">CRS</span>(<span class="st">&quot;+proj=aeqd +lat_0=0 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>))

<span class="kw">library</span>(tmap)
<span class="kw">qtm</span>(wrld_simpl.ae) <span class="op">+</span><span class="st"> </span><span class="kw">tm_layout</span>(<span class="dt">frame =</span> <span class="ot">FALSE</span>) </code></pre></div>
<p><img src="A2-Coordinate-Systems_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>The following chunk transforms the worl map to an Azimuthal equidistant projection centered on Maine.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wrld_simpl.aemaine &lt;-<span class="st"> </span><span class="kw">spTransform</span>(wrld_simpl, <span class="kw">CRS</span>(<span class="st">&quot;+proj=aeqd +lat_0=44.5 +lon_0=-69.8 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>))

<span class="kw">qtm</span>(wrld_simpl.aemaine)  <span class="op">+</span><span class="st"> </span><span class="kw">tm_layout</span>(<span class="dt">frame =</span> <span class="ot">FALSE</span>) </code></pre></div>
<p><img src="A2-Coordinate-Systems_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>The following chunk transforms the worl map to a World Robinson projection.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wrld_simpl.robin &lt;-<span class="st"> </span><span class="kw">spTransform</span>(wrld_simpl, <span class="kw">CRS</span>(<span class="st">&quot;+proj=robin +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>))
<span class="kw">qtm</span>(wrld_simpl.robin) <span class="op">+</span><span class="st"> </span><span class="kw">tm_style_natural</span>() <span class="op">+</span><span class="st"> </span><span class="kw">tm_layout</span>(<span class="dt">frame =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="A2-Coordinate-Systems_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>The following chunk transforms the worl map to a World sinusoidal projection.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wrld_simpl.sin &lt;-<span class="st"> </span><span class="kw">spTransform</span>(wrld_simpl, <span class="kw">CRS</span>(<span class="st">&quot;+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>))
<span class="kw">qtm</span>(wrld_simpl.sin) <span class="op">+</span><span class="st"> </span><span class="kw">tm_layout</span>(<span class="dt">frame =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="A2-Coordinate-Systems_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div id="example-of-failed-transformations" class="section level3 unnumbered">
<h3>Example of failed transformations</h3>
<p>As of maptools version 0.8-39, the following projection will generate an error.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Mercator world (54004)</span>
wrld_simpl.mercator &lt;-<span class="st"> </span><span class="kw">spTransform</span>(wrld_simpl, <span class="kw">CRS</span>(<span class="st">&quot;+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>))</code></pre></div>
<pre><code>non finite transformation detected:
     [,1] [,2] [,3] [,4]
Error in .spTransform_Polygon(input[[i]], to_args = to_args, from_args = from_args,  : 
  failure in Polygons 145 Polygon 1 points 
In addition: Warning message:
In .spTransform_Polygon(input[[i]], to_args = to_args, from_args = from_args,  :
  2 projected point(s) not finite</code></pre>
<p>The error suggests that there is a problem with (at least) one of the polygons–polygon <code>145</code>. We’ll create a function that will loop through each spatial element (polygon) and attempt a transformation to confirm that polygon <code>145</code> is indeed the sole problematic polygon.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prob.poly &lt;-<span class="st"> </span><span class="cf">function</span>(s){
  n.poly &lt;-<span class="st"> </span><span class="kw">length</span>(s<span class="op">@</span>polygons)
  crd    &lt;-<span class="st"> &quot;+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>
  
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n.poly){
    t1 &lt;-<span class="st"> </span>wrld_simpl[i, ]
    <span class="kw">tryCatch</span>(t1.merc &lt;-<span class="st"> </span><span class="kw">spTransform</span>(t1, <span class="kw">CRS</span>(crd)),
             <span class="dt">error =</span> <span class="cf">function</span>(e){<span class="kw">print</span>(<span class="kw">sprintf</span>(<span class="st">&quot;Could not project polygon %i&quot;</span>, i))},
             <span class="dt">warning =</span> <span class="cf">function</span>(w){})
  }
}</code></pre></div>
<p>Now apply the function to the <code>wrld_simpl</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run function with data</span>
<span class="kw">prob.poly</span>(wrld_simpl)</code></pre></div>
<p>Polygon <code>145</code> is indeed the lone problematic shape. Let’s plot it in its native coordinate system.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qtm</span>(wrld_simpl[<span class="dv">145</span>, ] )</code></pre></div>
<p><img src="A2-Coordinate-Systems_files/figure-html/unnamed-chunk-17-1.png" width="500" /></p>
<p>The problematic polygon covers Antarctica. Let’s transform all polygons except polygon <code>145</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wrld_simpl.mercator &lt;-<span class="st"> </span><span class="kw">spTransform</span>(wrld_simpl[<span class="op">-</span><span class="dv">145</span>,], <span class="kw">CRS</span>(<span class="st">&quot;+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>))

<span class="kw">qtm</span>(wrld_simpl.mercator) <span class="op">+</span><span class="st"> </span><span class="kw">tm_style_natural</span>() <span class="op">+</span><span class="st"> </span><span class="kw">tm_layout</span>(<span class="dt">frame =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="A2-Coordinate-Systems_files/figure-html/unnamed-chunk-18-1.png" width="500" /></p>
<p>This works, but we loose a large polygon. One possible solution is to <em>clean</em> the polygon’s geometry inside of R or in a GIS software such as QGIS or ArcMap. This step is not covered here but can be found via many online resources.</p>
<p>Another issue that can come up when transforming spatial data is when the location of the tangent line(s) or point in the CS definition forces polygon features to split across the 180° meridian. For example, re-centering the mercator projection to -69° will create the following map.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wrld_simpl.mercator &lt;-<span class="st"> </span><span class="kw">spTransform</span>(wrld_simpl[<span class="op">-</span><span class="dv">145</span>,], <span class="kw">CRS</span>(<span class="st">&quot;+proj=merc +lon_0=-69 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span>))

<span class="kw">qtm</span>(wrld_simpl.mercator)</code></pre></div>
<p><img src="A2-Coordinate-Systems_files/figure-html/last-chunk-1.png" width="500" /></p>
<p>The polygons are split and R does not know how to piece them together. Unfortunately, there are no easy workarounds to this other than converting the polygon to a polyline, splitting, and then rebuilding the polygon. Another solution is to convert the vector object to a raster then reproject the raster.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-manipulation-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="vector-operations-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
